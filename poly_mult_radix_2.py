import random
import math

#precompute the twiddle factors
w_rom = []
kesai = 7
q = 3329
inv_kesai = pow(kesai,2047) % q  # inv_kesai = 8778
#print(inv_kesai)
# w_rom长度为1024 但实际上用到了1023个 1不是旋转因子
w_rom =  2285
# print(len(w_rom))

# def DIT_NR_NTT(a,w_rom):
#     n = len(a)
#     log_n = int(math.log(n,2))
#     r = 1
#     for p in range(log_n-1,-1,-1):
#         J = int(pow(2,p))
#         for k in range(int(n/(2*J))):
#             w = w_rom
#             # r = r + 1
#             for j in range(J):
#                 u = a[k*2*J+j] % q
#                 t = (a[k*2*J+j+J] * w) % q
#                 a[k*2*J+j] = (u + t) % q
#                 a[k*2*J+j+J] = (u - t) % q

#     return a

# test()


# a = [1189,2336,3054,2801,3281,936,3195,651,1427,1501,1525,2207,3170,1887,1281,2251,484,1016,377,2838,2001,798,3220,1324,1772,2629,175,1264,2010,2189,3325,2817,
#      2420,1625,1842,1298,2280,1559,896,1254,1186,2383,2999,863,493,1921,1022,2777,190,3063,170,1984,1592,1381,1980,1112,2117,1667,1370,544,2787,1159,3047,3031,
#      3137,2330,2178,110,1059,249,745,2166,1828,1682,883,2111,2529,412,3168,301,2002,1938,3282,613,1417,343,1499,592,32,2911,2438,2731,2345,143,599,3128,
#      1813,1064,217,2904,937,1508,923,627,1055,734,1682,333,1865,1058,100,2598,3015,1598,2288,482,259,2427,1932,3023,784,1842,1736,1699,2395,1875,443,1039]

a = [1189,2420,3137,1813,1625,2330,1064,2336,2178,217,3054,1842,2904,2801,1298,110,2280,1059,937,3281,249,1508,936,1559,923,3195,896,745,651,1254,2166,627,
     1828,1055,1427,1186,734,1501,2383,1682,1525,2999,883,1682,863,2111,333,2207,1865,3170,493,2529,1887,1921,412,1058,1022,3168,100,1281,301,2598,2251,2777,
     190,2002,3015,484,1938,1598,1016,3063,2288,377,170,3282,2838,1984,613,482,1417,259,2001,1592,2427,798,1381,343,3220,1980,1499,1932,1112,592,3023,1324,
     784,1772,2117,32,2629,1667,2911,1842,1370,2438,1736,175,2731,1699,1264,544,2010,2787,2345,2395,1159,143,1875,2189,599,443,3325,3047,1039,2817,3031,3128]

# print(len(a))
# print(a[0],a[64])

# b = [1390,99, 1119, 1304, 2314, 782, 2090, 568, 335, 1586, 2291, 1287, 2403, 1510, 1665, 884, 3035, 3252, 1858, 2830, 127, 1408, 460, 2680, 526, 2929, 2582, 3154, 3092, 710, 736, 2660]
# print(len(b))

def DIT_NR_NTT(a,w_rom):
    n = len(a)
    # log_n = int(math.log(n,2))
    # r = 1
    # for p in range(log_n-1,-1,-1):
    #     J = int(pow(2,p))
    # for k in range(int(n/(64))):
    w = w_rom
    # r = r + 1
    for j in range(64):
        u = a[j] % q
        t = (a[j+64] * w) % q
        a[j] = (u + t) % q
        a[j+64] = (u - t) % q
        # print(u,t)
    return a

radix2 = DIT_NR_NTT(a,w_rom)

print("ffta = ",radix2)

# print(len(radix2))

ffta =  [2569, 2944, 1382, 2525, 2385, 1847, 2311, 404, 399, 2780, 2011, 975, 2842, 2143, 494, 2910, 1008, 312, 2505, 2404, 3159, 646, 629, 2999, 1533, 55, 570, 1111, 1544, 2400, 2046, 3235, 
         2266, 2011, 1735, 1068, 2483, 2220, 2676, 2796, 2715, 1083, 2804, 2077, 2652, 2712, 2330, 201, 695, 3088, 2457, 2228, 318, 2434, 364, 2765, 1518, 78, 947, 2737, 839, 1157, 437, 2894,
         3138, 1896, 1563, 1101, 865, 2813, 3146, 939, 628, 983, 768, 2709, 2966, 130, 2102, 639, 223, 1806, 2698, 829, 668, 2370, 1243, 119, 313, 3006, 1222, 379, 3087, 108, 2286, 1348,
         1390, 99, 1119, 1304, 2314, 782, 2090, 568, 335, 1586, 2291, 1287, 2403, 1510, 1665, 884, 3035, 3252, 1858, 2830, 127, 1408, 460, 2680, 526, 2929, 2582, 3154, 3092, 710, 736, 2660]